ecui=(function(){var e=baidu,d=e.dom,c=e.string,b=e.object,f=e.array,a=e.browser;return{dom:{addClass:d.addClass,children:d.children,contain:function(g,h){return g.contains?g.contains(h):g==h||!!(g.compareDocumentPosition(h)&16)},coordinates:function(g){d.getStyle(g,"position")!="absolute"&&(g.style.position="relative")},create:(function(){var g=document;return function(m,j){m=c.trim(m||"div");if(/^<(\w+)/.test(m)){var k=[],i=RegExp["$1"].toUpperCase(),l=0,h=g.createElement("div");switch(i){case"TD":case"TH":k.push("tr");case"TR":k.push("tbody");case"TBODY":k.push("table")}for(;i=k[l];l++){m="<"+i+">"+m+"</"+i+">"}h.innerHTML=m;k=[];while(l--){h=h.firstChild}while(i=h.firstChild){k.push(i);j?j.appendChild(i):h.removeChild(i)}return k.length>1?k:k[0]}else{i=document.createElement(m);j&&j.appendChild(i);return i}}})(),first:d.first,getInvalidHeight:function(g){return ecui.dom.sumStyles(g,"paddingTop","paddingBottom","borderTopWidth","borderBottomWidth")},getInvalidWidth:function(g){return ecui.dom.sumStyles(g,"paddingLeft","paddingRight","borderLeftWidth","borderRightWidth")},getPosition:d.getPosition,getStyle:d.getStyle,getText:function(g){return g[a.firefox?"textContent":"innerText"]},insertAfter:d.insertAfter,insertFloor:function(h){var i=document.createElement("div"),g;while(g=h.firstChild){i.appendChild(g)}return h.appendChild(i)},ready:d.ready,remove:function(h){var g=h.parentNode;g&&g.removeChild(h);return h},removeClass:d.removeClass,setInputName:function(i,g){var h=i;if(a.ie){if(i.name!=g){i=d.create('<input type="'+h.type+'" name="'+g+'">');i.value=h.value;i.className=h.className;i.disabled=h.disabled;i.readOnly=h.readOnly;i.style.cssText=h.style.cssText;d.insertAfter(i,h);d.remove(h)}}else{i.name=g}return i},setStyle:d.setStyle,setStyles:d.setStyles,setText:function(g,h){g[a.firefox?"textContent":"innerText"]=h},sumStyles:function(k){for(var h=1,j=0,g;g=arguments[h];h++){j+=parseInt(d.getStyle(k,g))||0}return j}},browser:baidu.browser,string:{toCamelCase:c.toCamelCase,trim:c.trim},array:{indexOf:f.indexOf,remove:f.remove},util:{copy:b.extend,inherits:function(i,h,g,j){var k=b.extend;e.lang.inherits(i,h);k(i.prototype,g);k(i,j)}},ui:{}}})();ecui.Timer=function(d,c,b){var a=Array.prototype.slice.call(arguments,3);this._nID=setTimeout(function(){d.apply(b,a);a=b=null},c)};ecui.Timer.prototype.stop=function(){clearTimeout(this._nID)};ecui.Browser=function(){var f=document,a=f.body,d=a.parentNode,b=f.compatMode=="BackCompat"?a:f.documentElement,e=d.scrollTop+a.scrollTop,h=d.scrollLeft+a.scrollLeft,g=b.clientWidth,c=b.clientHeight;return{top:e,right:g+h,bottom:c+e,left:h,width:Math.max(d.scrollWidth,a.scrollWidth,g),height:Math.max(d.scrollHeight,a.scrollHeight,c)}};ecui.util.copy(ecui,{_aControl:[],_aStack:[],_aConnect:{},_oData:{mousedown:function(b){var a=ecui,c;b=a.event(b);a.setFocused(c=b._cTarget);if(a._cPress=c){c.mousedown(b);c.pressstart(b)}},mouseover:function(d){a=ecui;d=a.event(d);var e=a._cPress,b=[a._cOver=d._cTarget],f=[a._cOutCache],a,c,g=a._oData.type;a._oddsParents(b,f);a._cOutCache=null;g=g!="drag"&&g!="zoom";c=f.length;while(c--){a=f[c];a.mouseout(d);e==a&&g&&a.pressout(d)}for(c=0;a=b[c];c++){a.mouseover(d);e==a&&g&&a.pressover(d)}},mousemove:function(a){a=ecui.event(a);for(var b=a._cTarget;b;b=b.getParent()){b.mousemove(a);ecui._cPress==b&&b.pressmove(a)}},mouseout:function(a){ecui._cOutCache=ecui.findControl(ecui.event(a).target)},mouseup:function(a){a=ecui.event(a);var b=ecui._cPress,c=a._cTarget;c&&c.mouseup(a);if(b){b.pressend(a);b.contain(c)&&b.click(a);ecui._cPress=null}}},$bind:(function(){function a(){return this._cControl}return function(b,c){b._cControl=c;b.getControl=a}})(),$connect:function(c,d,b){if(b){var e=ecui._oNamed[b],a=ecui._aConnect;e?d.call(c,e):(a[b]||(a[b]=[])).push({func:d,caller:c})}},$fastCreate:function(d,c,f){var b=ecui,a=b._aControl,e;f.uid="EC-"+a.length;e=new d(b.string.trim(c.className).split(/\s+/)[0],c,f);e.onpaint=b.cancel;e.$setParent(b.findControl(c.parentNode));a.push(e);return e},blank:function(){},calcHeightRevise:function(c){var a=ecui,b=a.dom.sumStyles;return(a._bFixPadding?b(c,"paddingTop","paddingBottom"):0)+(a._bFixBorder?b(c,"borderTopWidth","borderBottomWidth"):0)},calcLeftRevise:function(a){return ecui._bFixOffset&&ecui.dom.getStyle(a,"position")!="static"?ecui.dom.sumStyles(a,"borderLeftWidth"):0},calcTopRevise:function(a){return ecui._bFixOffset&&ecui.dom.getStyle(a,"position")!="static"?ecui.dom.sumStyles(a,"borderTopWidth"):0},calcWidthRevise:function(c){var a=ecui,b=a.dom.sumStyles;return(a._bFixPadding?b(c,"paddingLeft","paddingRight"):0)+(a._bFixBorder?b(c,"borderLeftWidth","borderRightWidth"):0)},cancel:function(){return false},capture:function(){if(!ecui._eTarget){ecui._eTarget=this;return true}},create:function(p,g){g=g||{};var f=ecui,r=g.parent,l=g.baseClass,c=g.element,a=g.id,d=g.type,b=f._aControl,k=0,h=f._aConnect,j=f.string,n=f.dom.addClass,e=j.trim,q=j.toCamelCase,m=b.length++;d&&d!=p||(d=g.type="ec-"+p.toLowerCase());g.uid="EC-"+m;if(c){if(j=c._cControl){return j}}else{c=f.dom.create()}n(c,d);l?n(c,l):(l=e(c.className));l=l.split(/\s+/)[0];j=new f.ui[q("-"+p)](l,c,g);if(r&&(j.onpaint=f.cancel)&&r!==true){j.setParent(r)}else{r=f.findControl(j.getOuter().parentNode);r&&(r.onappend&&r.onappend(j)===false||r.$append(j)===false||j.$setParent(r))}b[m]=j;b=g.decorate;b&&b.replace(/([^(]+)\(([^)]+)\)/g,function(u,t,w){t=f.ext[q("-"+e(t))];w=e(w).split(/\s+/);for(var v=0;u=w[v];v++){new t(j,u)}});j.$create(g);a&&(f._oNamed[a]=j);if(b=h[a]){for(h[a]=null;a=b[k];k++){a.func.call(a.caller,j)}}return j},custom:(function(){var a=ecui,b={type:"custom",mousedown:function(c){c=a.event(c);var d=a._cPress=c._cTarget;d.mousedown(c);d.pressstart(c)},mouseup:function(c){a.restore();a._oData.mouseup(c)}};return function(){if(a.capture.call(this)){a._oData.type=="forcibly"&&a._oData.target.$custom();a._setEnv(b)}}})(),drag:(function(){var b=ecui,e=document,c=Math,a=c.max,f=b.browser.ie,d={type:"drag",mousemove:function(h){h=b.event(h);var i=b._oData,k=i.target,l=k.getX()+b._nX-i.x,j=k.getY()+b._nY-i.y,g=c.min(a(l,i.left),i.right),m=c.min(a(j,i.top),i.bottom);k.ondragmove&&k.ondragmove(h,g,m)===false||k.$dragmove(h,g,m)===false||k.setPosition(g,m);i.x=b._nX+g-l;i.y=b._nY+m-j},mouseup:function(g){var h=b._oData.target;h.ondragend&&h.ondragend(b.event(g))===false||h.$dragend(g);b.restore();f&&e.body.releaseCapture(false);b._oData.mouseup(g)}};return function(m,l,g){if(l.type=="mousedown"){var h=b.dom.sumStyles,n=b.util.copy,j=m.getOuter(),k=j.offsetParent,i=k.tagName;n(d,i=="BODY"||i=="HTML"?b.Browser():{top:0,right:k.offsetWidth-h(k,"borderLeftWidth","borderRightWidth"),bottom:k.offsetHeight-h(k,"borderTopWidth","borderBottomWidth"),left:0});n(d,g);d.right=a(d.right-m.getWidth(),d.left);d.bottom=a(d.bottom-m.getHeight(),d.top);d.target=m;b._setEnv(d);j.style.position="absolute";f&&e.body.setCapture();m.ondragstart&&m.ondragstart(l)===false||m.$dragstart(l)}}})(),event:(function(){function c(){return this._cTarget}function a(){this.cancelBubble=true}function b(){this.returnValue=false}return function(g){var e=ecui,h=e._eTarget,d=document.body,f=d.parentNode;if(e.browser.ie){g=window.event;g.pageX=f.scrollLeft+d.scrollLeft+g.clientX-d.clientLeft-f.clientLeft;g.pageY=f.scrollTop+d.scrollTop+g.clientY-d.clientTop-f.clientTop;g.target=g.srcElement;g.which=g.keyCode;g.stopPropagation=a;g.preventDefault=b}if(h){g._cTarget=h._cControl;e._eTarget=null}e._nX=g.pageX;e._nY=g.pageY;e._nKey=g.which||e._nKey;g.getTarget=c;return g}})(),findControl:function(a){for(var b;a&&a.nodeType==1;a=a.parentNode){if(b=a._cControl){return b}}},forcibly:(function(){var a=ecui,b={type:"forcibly",mousedown:function(c){c=a.event(c);var d=a._oData.target;d.onforcibly&&d.onforcibly(c)===false||d.$forcibly(c)===false||a.restore()}};return function(c){b.target=c;a._setEnv(b)}})(),get:function(h){var d=ecui,c=d._on,e=document,g=window,a=e.body,b=d._oNamed,f=d._oData;if(!b){for(b in f){c(e,b,f[b])}c(g,"resize",d._resize);c(g,"unload",d._unload);d._oNamed=b={};e=d.dom.create('<div style="width:8px;padding:2px;border:1px solid;position:relative"><div style="left:0px;position:relative"></div></div>',a);d._bFixPadding=e.offsetWidth&4;d._bFixBorder=e.offsetWidth&2;d._bFixOffset=e.firstChild.offsetLeft>2;d.dom.remove(e);d.init(a)}return b[h]},getChildren:function(c){for(var a=[],b=0,d=ecui._aControl,e;e=d[b];b++){if(e.getParent()==c){a.push(e)}}return a},getFocused:function(){return ecui._cFocus},getKey:function(){return ecui._nKey},getMouseX:function(c){var a=ecui,b=a._nX;if(c){c=c.getOuter();b-=a.dom.getPosition(c).left+a.dom.sumStyles(c,"borderLeftWidth")}return b},getMouseY:function(c){var a=ecui,b=a._nY;if(c){c=c.getOuter();b-=a.dom.getPosition(c).top+a.dom.sumStyles(c,"borderTopWidth")}return b},getPressed:function(){return ecui._cPress},init:function(b){for(var f=0,h=b.getElementsByTagName("*"),g=ecui.string,c=g.trim,a=[];b=h[f];f++){a[f]=b}for(f=0;b=a[f];f++){if(h=b.getAttribute("ecui")){h=h.split(";");var e={},d=h.length;while(d--){var k=h[d].split(":"),j=k[1];if(j&&(j=c(j))){e[g.toCamelCase(c(k[0]))]=/^\d+(\.\d+)?$/.test(j)?j-0:j=="true"?true:j=="false"?false:j}}e.element=b;ecui.create(e.type,e)}}},loseFocus:function(a){a.contain(ecui._cFocus)&&ecui.setFocused(a.getParent())},mask:(function(){var a=[],b;return function(e,f){var c=ecui,d=c.Browser(),f=f||32767;b||(b=c.dom.create('<div style="position:absolute;top:0px;left:0px;background-color:#000"></div>',document.body));if("number"!=typeof e){if(e!==false){e||a.pop();e=a.length}if(!e){b.style.display="none";return}e=a[e-1];f=e[1];e=e[0]}else{a.push([e,f])}c.dom.setStyles(b,{width:d.width+"px",height:d.height+"px",display:"",opacity:e,zIndex:f})}})(),restore:function(){var b=ecui,d=b._oData,a=b._oData=b._aStack.pop(),c=d.type;b._setHandler(d,true);b._setHandler(a)},select:(function(){function d(e){e="select"+e;return new Function("e","var o=this._cTarget;o.on"+e+"&&o.on"+e+"(e)===false||o.$"+e+"(e)")}var c=ecui,b=Math.max,a={$setSize:function(h,e){var g=this.getOuter().firstChild,f=g.style;c.ui.Control.prototype.$setSize.call(this,h,e);f.width=b(1,h-c.calcWidthRevise(g))+"px";f.height=b(1,e-c.calcHeightRevise(g))+"px"},onzoomstart:d("start"),onzoommove:d(""),onzoomend:d("end")};return function(h,f,e){if(f.type=="mousedown"){var g=c._cSelect;if(!g){g=c._cSelect=c.create("Control",{element:c.dom.create('<div style="overflow:hidden"><div class="ec-selector-box"></div></div>',document.body)});c.util.copy(g,a)}g.setPosition(c._nX,c._nY);g.setSize(1,1);g.setClass(e||"ec-selector"),g.show();g._cTarget=h;c.zoom(g,f)}}})(),setFocused:function(d){var a=ecui,c=[a._cFocus],e=[a._cFocus=d];a._oddsParents(e,c);var b=c.length;while(b--){c[b].blur()}for(b=0;d=e[b];b++){d.focus()}},zoom:(function(){var b=ecui,e=document,c=Math,a=c.max,f=b.browser.ie,d={type:"zoom",mousemove:function(g){g=b.event(g);var j=void (0),h=b._oData,i=h.target;x=b._nX,width=h.width,expectWidth=h.width=x-h.x+width,y=b._nY,height=h.height,expectHeight=h.height=y-h.y+height,minWidth=h.minWidth,maxWidth=h.maxWidth,minHeight=h.minHeight,maxHeight=h.maxHeight;h.x=x;h.y=y;x=h.left;y=h.top;width=minWidth!==j?a(minWidth,expectWidth):expectWidth;height=minHeight!==j?a(minHeight,expectHeight):expectHeight;width=maxWidth!==j?c.min(maxWidth,width):width;height=maxHeight!==j?c.min(maxHeight,height):height;i.setPosition(width<0?x+width:x,height<0?y+height:y);i.onzoommove&&i.onzoommove(g)===false||i.$zoommove(g)===false||i.setSize(c.abs(width),c.abs(height))},mouseup:function(g){var h=b._oData.target;h.onzoomend&&h.onzoomend(b.event(g))===false||h.$zoomend(g);b.restore();f&&e.body.releaseCapture(false);h==b._cSelect?h.hide():b._resize();b._oData.mouseup(g)}};return function(i,h,g){if(h.type=="mousedown"){var j=b.util.copy;i.getOuter().style.position="absolute";g&&j(d,g);j(d,{left:i.getX(),top:i.getY(),width:i.getWidth(),height:i.getHeight()});d.target=i;b._setEnv(d);f&&e.body.setCapture();i.onzoomstart&&i.onzoomstart(h)===false||i.$zoomstart(h)}}})(),_oddsParents:function(a,e){var c=a.pop(),b=e.pop(),d=0;if(c!=b){while(c){a.splice(0,0,c);c=c.getParent()}while(b){e.splice(0,0,b);b=b.getParent()}for(;a[d]==e[d];d++){}a.splice(0,d);e.splice(0,d)}},_on:function(c,a,b){c.attachEvent?c.attachEvent("on"+a,b):c.addEventListener(a,b,false)},_setEnv:function(c){var d={},b=ecui,e=b.util.copy,a=b._oData;b._setHandler(a,true);e(d,a);e(d,c);d.x=b._nX;d.y=b._nY;b._setHandler(d);b._aStack.push(a);b._oData=d},_setHandler:function(e,a){for(var b=0,d=["mousedown","mouseover","mousemove","mouseout","mouseup"],c=ecui[a?"_un":"_on"],f;f=d[b];b++){e[f]&&c(document,f,e[f])}},_resize:(function(){var a;return function(){var c=ecui,d=0,f=c._aControl,e=c._oData,g=e.type,b=c.mask;b(false);if(g!="zoom"){g=="drag"&&e.mouseup();for(;g=f[d];d++){g.paint()}}c.browser.ie?(a=new ecui.Timer(b,0,null,true)):b(true)}})(),_un:function(c,a,b){c.detachEvent?c.detachEvent("on"+a,b):c.removeEventListener(a,b,false)},_unload:function(){for(var a=0,b=ecui._aControl,c;c=b[a];a++){c.dispose()}}});(function(){for(var d=0,e=["keydown","keypress","keyup"],a=ecui,b=a.browser,c=a._oData,f;f=e[d];d++){c[f]=new Function("e","e=ecui.event(e);for(var o=ecui._cFocus;o;o=o.getParent())if(o.isEnabled()&&(o.on"+f+"&&o.on"+f+"(e)===false||o.$"+f+"(e)===false))return false")}b.ie&&(c.dblclick=function(){var h=a._eTarget,g;if(h){a._eTarget=null;h.onmousedown()}g=a._oData;g.mousedown();g.mouseup()});c[b.firefox?"DOMMouseScroll":"mousewheel"]=function(h){var g=a._cFocus,i=a._cOver;h=a.event(h);h.wheelDelta||(h.wheelDelta=h.detail*-40);if(a._oData.type=="drag"||(i&&i.mousewheel(h)===false||g&&g.mousewheel(h)===false)){h.preventDefault()}};a.dom.ready(a.get)})();ecui.ui.Control=function(c,d,h){var e=this,a=ecui,b=0,g=d.style,f=["onmousedown","onmouseover","onmousemove","onmouseout","onmouseup","onclick"];e._sID=h.uid;e._sBaseClass=e._sClass=c;e._sType=h.type;/px$/.test(g.width)||(e._sWidth=g.width);/px$/.test(g.height)||(e._sHeight=g.height);e._eBase=e._eBody=d;e._bEnabled=true;for(;g=f[b];b++){e[g]=d[g];d[g]=null}h.capture!==false&&(d.onmousedown=d.onmouseover=d.onmousemove=d.onmouseout=d.onmouseup=a.capture);a.browser.ie&&(d.ondblclick=d.onmousedown);a.$bind(d,e)};ecui.util.copy(ecui.ui.Control.prototype,{$alterClass:function(d,b){var e=this,a=e._sType,c=e._sClass;e.onalterclassbefore&&e.onalterclassbefore(d,b);ecui.dom[b?"removeClass":"addClass"](e._eBase,c+"-"+d+(c!=a?" "+a+"-"+d:""));e.onalterclassend&&e.onalterclassend(d,b)},$blur:function(){this.alterClass("focus",true)},$create:function(){this.paint()},$dispose:function(){this._eBase=this._eBody=null},$focus:function(){this.alterClass("focus")},$getSection:function(a){return this["_u"+a]},$mouseout:function(){this.alterClass("over",true)},$mouseover:function(){this.alterClass("over")},$pressend:function(){this.alterClass("press",true)},$pressstart:function(){this.alterClass("press")},$resize:function(){var d=this,b=d._sWidth,a=d._sHeight,c=d.getBase().style,e=void (0);d.clearCache();b!==e&&(c.width=b);a!==e&&(c.height=a)},$setBody:function(a){this._eBody=a},$setBodyHTML:function(a){this._eBody.innerHTML=a},$setParent:function(a){this._cParent=a},$setSize:function(d,a){var e=this,c=e._eBase,b=c.style;if(d){b.width=d-ecui.calcWidthRevise(c)+"px";e._nWidth=d}if(a){b.height=a-ecui.calcHeightRevise(c)+"px";e._nHeight=a}e.$paint()},alterClass:function(b,a){this.$alterClass(b,a);this.clearCache()},clearCache:function(){this._nWidth=this._nHeight=void (0)},contain:function(a){for(var b=a;b;b=b._cParent){if(b==this){return true}}},dispose:function(){try{this.ondispose&&this.ondispose()}catch(a){}this.$dispose()},getBase:function(){return this._eBase},getBaseClass:function(){return this._sBaseClass},getBody:function(){return this._eBody},getBodyHeight:function(){return this.getHeight()-this.getHeightRevise()},getBodyWidth:function(){return this.getWidth()-this.getWidthRevise()},getClass:function(){return this._sClass},getHeight:function(){var b=this,a=b._eBase;return b._nHeight=b._nHeight||a.offsetHeight||ecui.dom.sumStyles(a,"height")+ecui.calcHeightRevise(a)},getHeightRevise:function(){return ecui.dom.getInvalidHeight(this._eBase)},getOuter:function(){return this._eBase},getParent:function(){return this._cParent},getType:function(){return this._sType},getUID:function(){return this._sID},getWidth:function(){var b=this,a=b._eBase;return b._nWidth=b._nWidth||a.offsetWidth||ecui.dom.sumStyles(a,"width")+ecui.calcWidthRevise(a)},getWidthRevise:function(){return ecui.dom.getInvalidWidth(this._eBase)},getX:function(){if(this.isShow()){var a=this.getOuter(),b=ecui.dom.getStyle(a,"left");return/px$/.test(b)?parseInt(b):a.offsetLeft-ecui.calcLeftRevise(a)}},getY:function(){if(this.isShow()){var a=this.getOuter(),b=ecui.dom.getStyle(a,"top");return/px$/.test(b)?parseInt(b):a.offsetTop-ecui.calcTopRevise(a)}},hide:function(){var c=this,b=c.getOuter(),a=b.style;if(c.isShow()){c._sDisplay=a.display;a.display="none";c.onhide&&c.onhide();ecui.loseFocus(c);return true}},isEnabled:function(){var a=this._cParent;return this._bEnabled&&(!a||a.isEnabled())},isShow:function(){var a=this.getOuter();return ecui.dom.getStyle(a,"display")!="none"&&!!a.offsetWidth},mousewheel:function(a){for(var b=this;b;b=b._cParent){if(b.isEnabled()&&(b.onmousewheel&&b.onmousewheel(a)===false||b.$mousewheel(a)===false)){return false}}},paint:function(){var f=ecui,k=f.dom.getStyle,l=this,d=l.getOuter(),c=l._eBase,a=c.style,g=l._sWidth,i=l._sHeight,e=void (0);if(!l.onpaint||l.onpaint()!==false){l.$resize();var b=l.getWidth(),p=l.getHeight();if(c!=d&&(g!==e||i!==e)){var h=c.nextSibling,j=c.parentNode;if(f.browser.ie){n=/px$/.test(k(c,"width"));m=/px$/.test(k(c,"height"))}else{var n=c.offsetWidth,m=c.offsetHeight;a=j.style;a.width=n+100+"px";a.height=m+100+"px";n=n==c.offsetWidth;m=m==c.offsetHeight}d.parentNode.appendChild(c);g!==e&&!n&&(b=c.offsetWidth);i!==e&&!m&&(p=c.offsetHeight);h?j.insertBefore(c,h):j.appendChild(c)}l.$setSize(b,p)}},setBodySize:function(b,a){this.setSize(b&&b+this.getWidthRevise(),a&&a+this.getHeightRevise())},setClass:function(b){var g=this,f=g._eBase,e=[],d=0,a=g._sType,c=g._sClass;b=b||a;if(b!=c){f.className.replace(new RegExp("(^|\\s)"+c+"(-[^\\s]+)","g"),function(i,h,j){e.push(a+j);a!=b&&e.push(b+j)});e.push(a);a!=b&&e.push(b);f.className=e.join(" ");g._sClass=b}},setEnabled:function(a){var b=this;a=a!==false;if(b._bEnabled!=a){b.alterClass("disabled",a);a||ecui.loseFocus(b);b._bEnabled=a}},setParent:function(e){var f=this,b=ecui,c=f._cParent,d=f.getOuter(),a;if(e){if(e instanceof b.ui.Control){a=e._eBody}else{a=e;e=b.findControl(e)}}if(e!=c){if(c){c.onremove&&c.onremove(f);c.$remove(f)}if(e&&(e.onappend&&e.onappend(f)===false||e.$append(f)===false)){e=a=null}}a?a.appendChild(d):b.dom.remove(d);f._cParent=e;f.clearCache()},setPosition:function(a,c){var b=this.getOuter().style;b.left=a+"px";b.top=c+"px"},setSize:function(b,a){var c=this,d=void (0);(b&&b!=c.getWidth()||a&&a!=c.getHeight())&&c.$setSize(b,a);b&&(c._sWidth=d);a&&(c._sHeight=d)},show:function(){var a=this;if(!a.isShow()){a.getOuter().style.display=a._sDisplay||"";a.onshow&&a.onshow();return true}}});(function(){for(var e=ecui.blank,a=ecui.ui.Control.prototype,b=0,c=["focus","blur","click","mousedown","mouseover","mousemove","mouseout","mouseup","pressstart","pressover","pressmove","pressout","pressend","change"],d;d=c[b];b++){a[d]=new Function("e","var o=this;"+(b<13?"o.isEnabled()&&":"")+"(o.on"+d+"&&o.on"+d+"(e)===false||o.$"+d+"(e))");a["$"+d]=a["$"+d]||e}a.$pressover=a.$pressstart;a.$pressout=a.$pressend;a.$paint=a.$mousewheel=a.$custom=a.$forcibly=a.$append=a.$remove=a.$keydown=a.$keypress=a.$keyup=a.$selectstart=a.$select=a.$selectend=a.$zoomstart=a.$zoommove=a.$zoomend=a.$dragstart=a.$dragmove=a.$dragend=e})();ecui.ui.Scroll=function(k,d,g){var m=this,f=ecui,j=f.create,a=f.util.copy,e=f.ui.Scroll,c=g.type,h=0,l=["Prev","Next"],b;f.ui.Control.call(m,k,d,g);f.dom.coordinates(m.getBody());for(;b=l[h];h++){g=b.toLowerCase();b=m["_u"+b]=j("Control",{baseClass:k+"-"+g,parent:m,type:c+"-"+g});b._fAction=e[g];a(b,e.Button);b.getBase().onmousedown=f.custom;g=b.getOuter().style;g.position="absolute";g.top=g.left="0px"}b=m._uBlock=j("Control",{baseClass:k+"-block",parent:m,type:c+"-block"});a(b,e.Block);b.$dragend=e.stop;b.getBase().onmousedown=f.custom;b.getOuter().style.position="absolute";m._nValue=m._nTotal=0;m._nStep=1;d.onmousedown=f.custom;d.onselectstart=f.cancel};ecui.util.inherits(ecui.ui.Scroll,ecui.ui.Control,{$pressend:function(a){ecui.ui.Scroll.stop.call(this);ecui.ui.Control.prototype.$pressend.call(this,a)},$pressout:function(a){ecui.ui.Scroll.stop.call(this);ecui.ui.Control.prototype.$pressout.call(this,a)},$pressover:function(a){this._fAction(this.$getPageStep());ecui.ui.Control.prototype.$pressover.call(this,a)},$pressstart:function(b){var a=this,c=ecui.ui;(a._fAction=c.Scroll[a.$allowPrev()?"prev":"next"]).call(a,a.$getPageStep());a.focus();c.Control.prototype.$pressstart.call(a,b);b.preventDefault()},$setValue:function(a){this._nValue=a},focus:function(){var a=this.getParent();a&&!a.contain(ecui.getFocused())&&ecui.setFocused(a)},getStep:function(){return this._nStep},getTotal:function(){return this._nTotal},getValue:function(){return this._nValue},hide:function(){this.setValue(0);return ecui.ui.Control.prototype.hide.call(this)},scroll:function(){var b=this,a=b.getParent();b.change();a&&(a.onscroll&&a.onscroll(b)===false||a.$scroll(b))},setStep:function(a){a>0&&(this._nStep=a)},setTotal:function(b){var a=this;if(b>=0&&a._nTotal!=b){a._nTotal=b;if(a._nValue>b){a._nValue=b;a.scroll()}a.$paint()}},setValue:function(b){var a=this;b=Math.max(Math.min(b,a._nTotal),0);if(a._nValue!=b){a._nValue=b;a.scroll();a.$paint()}},skip:function(b){var a=this;a.isShow()&&a.setValue(a._nValue+b*a._nStep)}},{Block:{$dragmove:function(c,a,e){var b=this.getParent(),d=b.$calcDragValue(a,e);b.$setValue(d==b._nTotal?d:d-d%b._nStep);b.scroll()},$mousedown:function(a){parent.focus();ecui.drag(this,a,this._oRange);a.preventDefault()},setRange:function(d,b,a,c){this._oRange={top:d,right:b,bottom:a,left:c}}},Button:{$pressend:function(a){ecui.ui.Scroll.stop.call(this.getParent());ecui.ui.Control.prototype.$pressend.call(this,a)},$pressout:function(a){ecui.ui.Scroll.stop.call(this.getParent());ecui.ui.Control.prototype.$pressout.call(this,a)},$pressover:function(a){ecui.ui.Scroll.press.call(this,a);ecui.ui.Control.prototype.$pressover.call(this,a)},$pressstart:function(a){ecui.ui.Scroll.press.call(this,a);ecui.ui.Control.prototype.$pressstart.call(this,a)}},next:function(d){var c=this,a=ecui,b=a.ui.Scroll,e=c._nValue;b.stop.call(c);if(e<c._nTotal){a.getPressed()==c&&!c.$allowNext()||c.setValue(e+d);c._oTimer=new a.Timer(b.next,200,c,d)}},press:function(c){var b=this,a=b.getParent();a.focus();b._fAction.call(a,Math.max(a._nStep,5));c.preventDefault()},prev:function(d){var c=this,a=ecui,b=a.ui.Scroll,e=c._nValue;b.stop.call(c);if(e){a.getPressed()==c&&!c.$allowPrev()||c.setValue(e-d);c._oTimer=new a.Timer(b.prev,200,c,d)}},stop:function(){var a=this._oTimer;a&&a.stop()}});ecui.ui.VScroll=function(a,b,c){ecui.ui.Scroll.call(this,a,b,c)};ecui.util.inherits(ecui.ui.VScroll,ecui.ui.Scroll,{$allowNext:function(){var a=this._uBlock;return ecui.getMouseY(this)>a.getY()+a.getHeight()},$allowPrev:function(){return ecui.getMouseY(this)<this._uBlock.getY()},$calcDragValue:function(a,e){var c=this,d=c._uBlock,b=d._oRange;return(e-b.top)/(b.bottom-c._uPrev.getHeight()-d.getHeight())*c._nTotal},$getPageStep:function(){var a=this.getHeight();return a-a%this._nStep},$paint:function(){var d=this,c=Math.floor,b=d._nTotal,g=d._uBlock,a=d.getHeight(),h=d._uPrev.getHeight(),f=d.getBodyHeight(),e=Math.max(c(f*a/(a+b)),g.getHeightRevise()+5);if(b){g.setSize(0,e);g.setPosition(0,h+c((d._nValue/b)*(f-e)));g.setRange(h,0,f+h,0)}},$setSize:function(b,i){var g=this,d=ecui,a=d.dom.sumStyles,f=g.getBody(),h,e=g._uNext,c=a(f,"paddingTop");g.$paint=d.blank;d.ui.Scroll.prototype.$setSize.call(g,b,i);delete g.$paint;h=g.getBodyWidth();g._uPrev.setSize(h,c);e.setSize(h,a(f,"paddingBottom"));g._uBlock.setSize(h);e.setPosition(0,g.getBodyHeight()+c);g.$paint()}});ecui.ui.HScroll=function(a,b,c){ecui.ui.Scroll.call(this,a,b,c)};ecui.util.inherits(ecui.ui.HScroll,ecui.ui.Scroll,{$allowNext:function(){var a=this._uBlock;return ecui.getMouseX(this)>a.getX()+a.getWidth()},$allowPrev:function(){return ecui.getMouseX(this)<this._uBlock.getX()},$calcDragValue:function(a,e){var c=this,d=c._uBlock,b=d._oRange;return(a-b.left)/(b.right-c._uPrev.getWidth()-d.getWidth())*c._nTotal},$getPageStep:function(){var a=this.getWidth();return a-a%this._nStep},$paint:function(){var f=this,e=Math.floor,d=f._nTotal,h=f._uBlock,b=f.getWidth(),c=f._uPrev.getWidth(),a=f.getBodyWidth(),g=Math.max(e(a*b/(b+d)),h.getWidthRevise()+5);if(d){h.setSize(g);h.setPosition(c+e((f._nValue/d)*(a-g)),0);h.setRange(0,a+c,0,c)}},$setSize:function(b,h){var f=this,c=ecui,a=c.dom.sumStyles,e=f.getBody(),i,d=f._uNext,g=a(e,"paddingLeft");f.$paint=c.blank;c.ui.Scroll.prototype.$setSize.call(f,b,h);delete f.$paint;i=f.getBodyHeight();f._uPrev.setSize(g,i);d.setSize(a(e,"paddingRight"),i);f._uBlock.setSize(0,i);d.setPosition(f.getBodyWidth()+g,0);f.$paint()}});ecui.ui.Panel=function(f,b,c){var h=this,a=ecui,j=a.dom.insertFloor,e=a.create,g=[],d=0;a.ui.Control.call(h,f,b,c);h._bAbsolute=!!c.absolute;h._nWheelDelta=c.wheelDelta;a.dom.coordinates(b);c.vScroll!==false&&g.push("VScroll");a=j(b);a.style.cssText=(g.length?"white-space:nowrap;":"")+"position:absolute;top:0px;left:0px";h.$setBody(a);c.hScroll!==false&&g.push("HScroll");a=j(b);a.className=f+"-layout";a.style.cssText="overflow:hidden;position:absolute";for(;a=g[d];d++){(h["_u"+a]=e(a,{baseClass:f+"-"+a.toLowerCase(),parent:b})).getOuter().style.position="absolute";d&&((h._uCorner=e("Control",{baseClass:f+"-corner",parent:b,type:c.type+"-corner"})).getOuter().style.position="absolute")}};ecui.util.inherits(ecui.ui.Panel,ecui.ui.Control,{$keypress:function(c){var e=ecui.getKey(),b=e%2,d=c.target,a;if(e>=37&&e<=40&&!d.value){a=b?this._uHScroll:this._uVScroll;a&&a.skip(e+b-39);return false}},$mousewheel:function(c){var b=this,a=b._uVScroll;if(a&&a.isShow()){var d=a.getValue(),e=b._nWheelDelta||Math.floor(20/a.getStep())||1;a.skip(c.wheelDelta<0?e:-e);return d==a.getValue()}},$paint:function(){var E=this,v=ecui,u=v.dom,f=E.getBody(),a=E.getBase(),m=u.sumStyles,C=u.getPosition,t=m(a,"paddingLeft","paddingRight"),k=m(a,"paddingTop","paddingBottom"),g=f.offsetWidth,l=f.offsetHeight,A=E.getBodyWidth(),n=E.getBodyHeight(),D=E._uVScroll,z=E._uHScroll,c=E._uCorner,B=D&&D.getWidth(),j=z&&z.getHeight(),p=A-B,q=n-j,w=p+t,h=q+k,r=0,b=C(f),e=b.left,d=b.top;if(E._bAbsolute){for(E=f.getElementsByTagName("*");m=E[r];r++){if(m.offsetWidth&&u.getStyle(m,"position")!="static"){b=C(m);g=Math.max(g,b.left-e+m.offsetWidth);l=Math.max(l,b.top-d+m.offsetHeight)}}}D&&D.setPosition(w,0);z&&z.setPosition(0,h);c&&c.setPosition(w,h);if(g<=A&&l<=n){D&&D.hide();z&&z.hide();c&&c.hide()}else{while(true){if(c){if(g>p&&l>q){z.show();z.setTotal(g-p);z.setSize(w);D.show();D.setTotal(l-q);D.setSize(0,h);c.show();c.setSize(B,j);A=p;n=q;break}c.hide()}if(z){if(g>A){z.show();z.setTotal(g-A-u.sumStyles(f.parentNode,"borderLeftWidth","borderRightWidth"));z.setSize(A+t);D&&D.hide();n=q}else{z.hide()}}else{if(D){if(l>n){z&&z.hide();D.show();D.setTotal(l-n);D.setSize(0,n+k);A=p}else{D.hide()}}}break}}m=f.parentNode;E=m.style;E.width=A-v.calcWidthRevise(m)+"px";E.height=n-v.calcHeightRevise(m)+"px"},$scroll:function(){var c=this,b=c.getBody().style,a=c.getScrollLeft();a>=0&&(b.left=-a+"px");(a=c.getScrollTop())>=0&&(b.top=-a+"px")},getScrollLeft:function(){var a=this._uHScroll;return a?a.getValue():-1},getScrollTop:function(){var a=this._uVScroll;return a?a.getValue():-1}});ecui.ui.Panel.prototype.$keydown=ecui.ui.Panel.prototype.$keypress;ecui.ui.Edit=function(f,a,d){var h=this,c=ecui,e=c.dom,b=c.ui.Edit,i=a,g=["onkeydown","onkeypress","onkeyup","onfocus","onblur","onchange"];if(a.tagName=="INPUT"){a=e.create();e.insertAfter(a,i);a.appendChild(i);a.className=i.className}else{if(i=a.getElementsByTagName("input")[0]){a.innerHTML="";a.appendChild(i)}else{a.innerHTML='<input name="'+(d.name||"")+'">';i=a.firstChild;i.value=d.value||""}}h._eInput=i;c.ui.Control.call(h,f,a,d);a.style.overflow="hidden";i.className=f+"-input";i.style.border="none";for(a=0;d=g[a];a++){h[d]=i[d]}i.onchange=null;c.util.copy(i,b.Input);c.browser.ie?b.stop.call(h,false):i.addEventListener("input",b.change,false);e.setStyle(h.getOuter(),"display","inline-block")};ecui.util.inherits(ecui.ui.Edit,ecui.ui.Control,{$setSize:function(c,a){var d=this,b=d._eInput.style;ecui.ui.Control.prototype.$setSize.call(d,c,a);b.width=d.getBodyWidth()+"px";b.height=d.getBodyHeight()+"px"},getInput:function(){return this._eInput},getName:function(){return this._eInput.name},getValue:function(){return this._eInput.value},setCaret:ecui.browser.ie?function(b){var a=this._eInput.createTextRange();a.moveStart("character",b);a.collapse(true);a.select()}:function(a){this._eInput.setSelectionRange(a,a)},setEnabled:function(a){ecui.ui.Control.prototype.setEnabled.call(this,a);this._eInput.readOnly=a===false},setName:function(a){this._eInput=ecui.dom.setInputName(this._eInput,a)},setValue:function(c){var b=this,a=ecui.ui.Edit.stop;a.call(b);b._eInput.value=c;b.change();a.call(b,false)},split:ecui.browser.ie?function(){var d=this._eInput,b=document.selection.createRange(),a=b.text;b.setEndPoint("StartToStart",d.createTextRange());var c=b.text.length,e=d.value;return{left:e.substring(0,c-a.length),right:e.substring(c),selection:a}}:function(){var b=this._eInput,c=b.value,d=b.selectionStart,a=b.selectionEnd;return{left:c.substring(0,d),right:c.substring(a),selection:c.substring(d,a)}}},{Input:{onblur:function(){var a=ecui,b=a.findControl(this);b.$blur=a.ui.Control.prototype.$blur;b.isEnabled()&&a.loseFocus(b);delete b.$blur},onfocus:function(){var a=ecui,b=a.findControl(this);b.$focus=a.ui.Control.prototype.$focus;b.isEnabled()?a.setFocused(b):this.blur();delete b.$focus}},change:ecui.browser.ie?function(){if(event.propertyName=="value"){var b=ecui.findControl(this),a=ecui.ui.Edit.stop;a.call(b);b.change();a.call(b,false)}}:function(){ecui.findControl(this).change()},stop:ecui.browser.ie?function(a){this._eInput.onpropertychange=a!==false?null:ecui.ui.Edit.change}:ecui.blank});(function(){for(var c=ecui.ui.Edit,e=c.Input,b=0,d=["keydown","keypress","keyup"],a;a=d[b];b++){e["on"+a]=new Function("e","var c=ecui,o=c.findControl(this),s=c.ui.Edit.stop,r;e=c.event(e);e.stopPropagation();if(o.on"+a+"){s.call(o);r=o.on"+a+"(e)!==false&&o.$"+a+"(e);s.call(o,false);return r}")}for(e=c.prototype,b=0,d=["blur","focus"];a=d[b];b++){e["$"+a]=new Function("var e=this._eInput,f=e.on"+a+";e.on"+a+"=null;try{e."+a+"()}catch(v){}e.on"+a+"=f;ecui.ui.Control.prototype.$"+a+".call(this)")}})();ecui.ui.Label=function(a,b,c){ecui.ui.Control.call(this,a,b,c);ecui.$connect(this,this.setFor,c["for"])};ecui.util.inherits(ecui.ui.Label,ecui.ui.Control,{$click:function(a){var b=this._cFor;b&&b.click(a)},setFor:function(a){this._cFor=a}});ecui.ui.Checkbox=function(a,b,e){var d=this,c=b.tagName=="INPUT"?b.checked:e.checked;ecui.ui.Edit.call(d,a,b,e);b=d.getInput();b.style.display="none";b.checked=true;d._aInferior=[];d._nStatus=2;d.setChecked(c);ecui.$connect(d,d.setSuperior,e.superior)};ecui.util.inherits(ecui.ui.Checkbox,ecui.ui.Edit,{$click:function(){this.setChecked(this._nStatus)},$keydown:function(a){if(a.which==32){return false}},$keypress:function(a){if(a.which==32){return false}},$keyup:function(a){if(a.which==32){this.$click(a);return false}},$paint:function(){for(var c=0,b=this._aInferior,a,d;d=b[c];c++){if(c&&a!=d._nStatus){a=2;break}a=d._nStatus}c&&ecui.ui.Checkbox.change.call(this,a)},getInferiors:function(){return this._aInferior},getSuperior:function(){return this._cSuperior},isChecked:function(){return !this._nStatus},setChecked:function(a){if(ecui.ui.Checkbox.change.call(this,a?0:1)){for(var c=0,b=this._aInferior,d;d=b[c];c++){d.setChecked(a)}}},setSuperior:function(c){var b=this,a=b._cSuperior;if(a){ecui.array.remove(a._aInferior,b);a.$paint()}if(c){c._aInferior.push(b);c.$paint()}b._cSuperior=c}},{change:(function(){var b=["-checked","","-part"];function a(d,c){this.setClass(this.getBaseClass()+b[d],c)}return function(d){var e=this,f=e._cSuperior,c=e._nStatus;if(d!==c){a.call(e,c,true);a.call(e,d);e._nStatus=d;e.getInput().disabled=!!d;f&&f.$paint();e.change();return true}}})()});ecui.ui.Radio=function(b,c,f){var d=this,e=ecui.dom,a={};if(c.tagName=="INPUT"){c=e.insertAfter(e.create(),a=c);e.remove(a);c.className=a.className}ecui.ui.Control.call(d,b,c,f);d.setName(a.name||f.name||"");d.setValue(a.value||f.value||"");(f.checked||a.checked)&&d.checked();e.setStyle(d.getOuter(),"display","inline-block")};ecui.util.inherits(ecui.ui.Radio,ecui.ui.Control,{$click:function(){this.checked()},checked:function(){var c=this,d=c.getItems();if(d){var b=d._cCheck,a=d._eInput;if(b!=c){b&&b.setClass(b.getBaseClass());b=a.onpropertychange;a.onpropertychange=null;a.value=c._sValue;a.onpropertychange=b;d._cCheck=c}}c.setClass(c.getBaseClass()+"-checked")},getItems:function(){return ecui.ui.Radio["EC-"+this._sName]},getName:function(){return this._sName||null},getValue:function(){return this._sValue},isChecked:function(){var a=this.getItems();return a&&a._cCheck==this},setName:(function(){function a(){if(event.propertyName=="value"){var b=0,c=this,d=c.value,e=ecui.ui.Radio["EC-"+c.name];c.onpropertychange=null;for(;c=e[b];b++){if(c._sValue==d){c.checked();break}}}}return function(c){var e=this,b=ecui,d=b.ui.Radio,g=e._sName,f=d["EC-"+g];if(c!=g){if(f){g=f._eInput;if(f._cCheck==e){f._eInput.value="";f._cCheck=null}b.array.remove(f,e);f=f[0];f?f.getBody().appendChild(g):b.dom.remove(g)}if(c){e.setClass(e.getBaseClass());f=d[g="EC-"+c];if(!f){f=d[g]=[];g=f._eInput=b.dom.create('<input type="hidden" name="'+c+'">',e.getBody());b.browser.ie&&(g.onpropertychange=a)}f.push(e)}e._sName=c}}})(),setValue:function(a){this._sValue=a}});ecui.ui.Item=function(a,b,c){ecui.ui.Control.call(this,a,b,c);this.getBody().style.overflow="hidden"};ecui.util.inherits(ecui.ui.Item,ecui.ui.Control,{$mouseout:ecui.blank,$mouseover:function(e){var d=this,b=ecui.ui.Control.prototype,c=d.getParent(),a=c.getItems(),f=a._cOver;if(d!=f){f&&b.$mouseout.call(f);b.$mouseover.call(d);a._cOver=d}},alterClass:function(c,e){var d=this,b=d.getWidth(),a=d.getHeight();ecui.ui.Control.prototype.alterClass.call(d,c,e);d.setSize(b,a)},setParent:function(c){var e=this,f=ecui.ui,b=e._fType,a=e.getParent(),d=f.Control.prototype.setParent;if(c&&f.Items[c.getUID()]){b||(b=e._fType=c.constructor);if(c instanceof b){d.call(e,c);c=e.getParent();a&&a.$paint();c&&c.$paint();return}c=null}d.call(e,c)}});ecui.ui.Items={$append:function(a){if(!(a instanceof ecui.ui.Item)){return false}this.getItems().push(a)},$initItems:function(){var d=this,a=ecui,f=d.getUID(),b=0,e=a.dom.children(d.getBody()),c;d.$paint=a.blank;a.ui.Items[f]=[];for(;c=e[b];b++){d.add(c)}delete d.$paint},$remove:function(a){ecui.array.remove(this.getItems(),a)},add:function(g,c){var f=this,a=ecui,e=a.create,b=f.getItems(),h=g,d=f.getClass()+"-item";if(g instanceof a.ui.Item){g.setParent(f)}else{f.$paint=a.blank;if("string"==typeof g){g=e("Item",{baseClass:d,parent:f});g.$setBodyHTML(h)}else{g=e("Item",{baseClass:d,element:g,parent:f})}h=f.$initItem;e=Array.prototype.slice.call(arguments,1);e[0]=g;h&&h.apply(f,e);delete f.$paint;f.$paint()}if(g.getParent()&&(h=b[c])&&h!=g){f.getBody().insertBefore(g.getOuter(),h.getOuter());b.splice(c,0,b.pop())}return g},append:function(a){a=Array.prototype.slice.call(arguments);a.splice(1,0,void (0));this.add.apply(this,a)},clearOvered:function(){var a=this.getItems(),b=a._cOver;b&&ecui.ui.Control.prototype.$mouseout.call(b);a._cOver=null},getItems:function(){return ecui.ui.Items[this.getUID()]},getOvered:function(){return this.getItems()._cOver},remove:function(a){"number"==typeof a&&(a=this.getItems()[a]);a&&a.setParent()},setItemSize:function(d,e){for(var b=0,a=this.getItems(),c;c=a[b];b++){c.setSize(d,e)}}};ecui.ui.Select=function(k,c,f){var d=ecui,g=d.dom,m=g.create,j=d.create,h=0,n=c.options,a=c,e=-1;if(n){c=g.insertAfter(m(),c);for(;b=n[h];h++){l=m("",c);g.setText(l,b.text);l.setAttribute("value",b.value);b.selected&&(e=h)}c.className=a.className;g.remove(a);f.name=a.name||f.name}var l=this,b=l._uOptions=j("Panel",{baseClass:k+"-options",element:g.insertFloor(c),parent:document.body,hScroll:false});l._cScroll=b.$getSection("VScroll");d.ui.Edit.call(l,k,c,f);g.coordinates(l.getBody());l.getInput().style.display="none";b.hide();b.$setParent(l);g.setStyles(b.getOuter(),{zIndex:65535,position:"absolute"});c=b.getBody();l._nOptionSize=f.optionSize||5;l.$append=d.blank;b=l._uText=j("Item",{baseClass:k+"-text",parent:l,capture:false});b=l._uButton=j("Control",{baseClass:k+"-button",parent:l,capture:false});b.getOuter().style.position="absolute";l.$setBody(c);d.browser.ie&&(l.$change=d.ui.Select.change);delete l.$append;l.$initItems();e>=0?l.setSelected(e):l.setValue(l.getValue())};ecui.util.inherits(ecui.ui.Select,ecui.ui.Edit,{$forcibly:function(b){var a=this,c=b.getTarget();a._uOptions.hide();ecui.mask();c&&c.getParent()==a&&a.setSelected(c)},$initItem:function(b,c){var a=ecui,c=c===void (0)?b.getBase().getAttribute("value"):c;b.setSize(0,this._uText.getHeight(),true);b.mousewheel=a.ui.Select.mousewheel;b._sValue=c===null?a.dom.getText(b.getBody()):c;a.util.copy(b,a.ui.Select.Item)},$keydown:function(a){var i=this,d=ecui,e=a.which,h=i.getItems(),g=i.getOvered(),m=i._uOptions;if(d.getPressed()!=i){if(!m.isShow()){if(e==40||e==13){i.$pressstart();i.$pressend();return false}}else{if(e==40||e==38){var b=h.length,l=i._nOptionSize,j=i._cScroll,c=j.getStep(),k=j.getValue()/c,f=d.array.indexOf(h,d.ui.Select.move.call(i,e==40?1:-1,true));j.skip((f<k?f:f>=k+l?f-l+1:k)-k);return false}else{if(e==13||e==27){m.hide();e==13&&g&&i.setSelected(g);d.mask();d.restore()}}}}},$keypress:function(a){var b=ecui.getKey();return b<37||b>40||b==13},$mousewheel:function(a){if(!this._uOptions.isShow()){this.setSelected(ecui.ui.Select.move.call(this,a.wheelDelta<0?1:-1));return false}},$paint:function(){var g=this,b=ecui,m=g._uOptions,j=g._cScroll,a=j.getStep(),i=b.dom.getPosition(g.getOuter()),f=g.getItems(),e=f.length,d=g._cSelect,l=g._nOptionSize,h=i.top,c=h+g.getHeight(),k;if(m.isShow()){g.setItemSize(m.getBodyWidth()-(e>l?j.getWidth():0));m.setBodySize(0,(Math.min(e,l)||1)*a);m.$paint();k=m.getHeight();m.setPosition(i.left,c+k<=b.Browser().bottom?c:h-k);d&&d.$mouseover();j.setValue(a*b.array.indexOf(f,d))}},$pressend:function(a){ecui.ui.Edit.prototype.$pressend.call(this,a);ecui.forcibly(this);ecui.mask(0,65534)},$pressstart:function(a){ecui.ui.Edit.prototype.$pressstart.call(this,a);this._uOptions.show();this.$paint()},$setSize:function(b,a){var c=this,d=c._uOptions;d.$paint=ecui.blank;ecui.ui.Edit.prototype.$setSize.call(c,b,a);a=c.getBodyHeight();d.setSize(b);c._cScroll.setStep(a);c.setItemSize(0,a);delete d.$paint;b=c.getBodyWidth()-a;c._uText.setSize(b,a,true);d=c._uButton;d.setSize(a,a);d.setPosition(b,0);c.$paint()},getSelected:function(){return this._cSelect},setSelected:function(d){var c=this,f=c._uText,b=ecui.ui.Edit.prototype.setValue;"number"==typeof d&&(d=c.getItems()[d]);if(c._cSelect!=d){if(d){var a=d.getBody(),e=d._sValue;f.$setBodyHTML(a.innerHTML);b.call(c,e!==void (0)?e:ecui.dom.getText(a))}else{f.$setBodyHTML("");b.call(c,"")}c._cSelect=d}},setOptionSize:function(a){if(a>1){this._nOptionSize=a;this.$paint()}},setValue:function(d){var c=this,b=0,a=c.getItems(),e;c.change=ecui.blank;for(;e=a[b];b++){if(e._sValue==d){c.setSelected(e);break}}e||c.setSelected();delete c.change}},{change:function(){var b=this,a=b._cSelect,c=b.getValue();delete b.$change;if(a&&a._sValue!=c){b.setValue(c)}},move:function(g,b){var e=this,c=ecui.array.indexOf,a=e.getItems(),d=a.length,f=b?e.getOvered():e._cSelect;if(d){g=b?((f?c(a,f):g>0?d-1:0)+g+d)%d:c(a,f)+g;if(g>=0&&g<d){f=a[g];f.$mouseover()}}return f},mousewheel:function(a){this.getParent()._uOptions.mousewheel(a);return false},Item:{getValue:function(){return this._sValue}}});ecui.util.copy(ecui.ui.Select.prototype,ecui.ui.Items);ecui.ui.Select.prototype.$remove=function(a){this._cSelect==a&&this.setSelected();ecui.ui.Items.$remove.call(this,a)};ecui.ui.Grid=function(l,b,f){var n=this,d=ecui,h=d.dom,m=n._aItem=[],r=h.children(b),p=0,k=0,e=r.length,q=n._nRow=f.row||e;d.ui.Control.call(n,l,b,f);for(;k<e;k++){for(var g=0,a=r[k]=h.children(h.remove(r[k])),c;c=a[g];g++){h.remove(c)}p=Math.max(p,a.length)}c=n._nCol=f.col||p;for(k=0;k<q;k++){if(a=r[k]){for(g=0;g<c;g++){m.push(a[g])}}}p=f.type;for(k=0,g=c*q;k<g;k++){a=m[k]||h.create();h.setStyle(a,"float","left");a=m[k]=d.create("Control",{baseClass:l+"-item",element:a,parent:n,type:p+"-item"});d.util.copy(a,d.ui.Grid.Item);a._nIndex=k}};ecui.util.inherits(ecui.ui.Grid,ecui.ui.Control,{$setSize:function(a,j){var g=this,f=g._aItem,c=g._nCol,k=g._nRow,d=0,b,h=g.getWidthRevise(true),e=g.getHeightRevise(true);if(f.length){a=Math.floor(((a?a:g.getWidth(true))-h)/c);j=Math.floor(((j?j:g.getHeight(true))-e)/k);for(;b=f[d];d++){b.setSize(a,j)}ecui.ui.Control.prototype.$setSize.call(g,a*c+h,j*k+e)}},getItem:function(b,a){return this._aItem[a===void (0)?b:b*this._nCol+a]}},{Item:{getIndex:function(){return this._nIndex}}});(function(){for(var a=0,c=ecui.ui.Grid.Item,b=["focus","blur","click","mousedown","mouseover","mousemove","mouseout","mouseup","pressstart","pressover","pressmove","pressout","pressend"],d;d=b[a];a++){c[d]=new Function("e","var o=this,p=o.getParent();o.isEnabled()&&(p.on"+d+"&&p.on"+d+".call(o,e)===false||p.$"+d+".call(o,e))")}})();ecui.ui.Calendar=function(f,a,c){var j=this,b=ecui,e=b.create,h=b.dom.insertFloor(a),d=0,g=j._uNames=e("Grid",{baseClass:f+"-weekname",element:a.insertBefore(b.dom.create(),h),parent:true,col:7,row:1});b.ui.Control.call(j,f,a,c);for(;d<7;d++){g.getItem(d).$setBodyHTML(j.WEEKNAMES[d])}g=j._uDate=e("Grid",{baseClass:f+"-date",element:h,parent:true,col:7,row:6});g.$click=b.ui.Calendar.dateclick;j.setDate(c.year,c.month)};ecui.util.inherits(ecui.ui.Calendar,ecui.ui.Control,{WEEKNAMES:["日","一","二","三","四","五","六"],$setSize:function(c,a){var d=this,e=d._uNames,b=d._uDate;e.$setSize(c);b.$setSize(c);ecui.ui.Control.prototype.$setSize.call(d,b.getWidth()+d.getWidthRevise(true),e.getHeight()+b.getHeight()+d.getHeightRevise(true))},getMonth:function(){return this._nMonth+1},getYear:function(){return this._nYear},move:function(c){var a=this,b=new Date(a._nYear,a._nMonth+c,1);a.setDate(b.getFullYear(),b.getMonth()+1)},setDate:function(k,g){var j=this,l=new Date(),m=j._nYear,n=j._nMonth,k=k||l.getFullYear(),g=g?g-1:l.getMonth();if(m!=k||n!=g){j._nYear=k;j._nMonth=g;l=l.getDate();for(var d=new Date(k,g,0),f=day=1-(d.getDay()+1)%7,p=d.getDate(),c=j._uDate,e=0,h,a,d=new Date(k,g+1,0),b=d.getDate();a=c.getItem(e);e++,day++){h=day>0&&day<=b;a.setEnabled(h);a.$setBodyHTML(h?day:day<=0?p+day:day-b);a.alterClass("today",day!=l);a._nDay=day}j.change()}}},{dateclick:function(){var b=this,c=b.getParent().getParent(),a=b._nDay;c.ondateclick&&c.ondateclick(new Date(c._nYear,c._nMonth,a))}});ecui.ui.Form=function(i,b,f){var j=this,d=ecui,g=d.dom,h=d.create,c=d.ui.Form,e=g.insertFloor(b),a=g.first(e);a=b.insertBefore(a&&a.tagName=="LABEL"?a:g.create(),e);j._nTitleAuto={width:1,height:2}[f.titleAuto];d.ui.Control.call(j,i,b,f);g.coordinates(j.getBody());a=j._uTitle=h("Control",{baseClass:i+"-title",element:a,parent:true});a.$mousedown=c.titledown;a.getBase().onmousedown=d.custom;a.getOuter().style.position="absolute";a=j._uClose=h("Control",{baseClass:i+"-close",parent:b});a.$click=c.closeclick;a.getOuter().style.position="absolute";a=(j._uMain=h("Panel",{baseClass:i+"-main",element:e,parent:true,absolute:f.absolute})).getBody();g.coordinates(a);j.$setBody(a);j.getOuter().style.zIndex=c._aForm.push(j)-1+c._nBaseIndex;f.hide&&j.hide()};ecui.util.inherits(ecui.ui.Form,ecui.ui.Control,{$focus:function(){var e=this,a=ecui,d=a.ui.Form,b=d._aForm,c=a.array.indexOf(b,e),f;a.ui.Control.prototype.$focus.call(e);if(e.getOuter().style.zIndex<32768){b.push(b.splice(c,1)[0]);for(;f=b[c];c++){f.getOuter().style.zIndex=c+d._nBaseIndex}}},$setSize:function(d,b){var e=this,f=e._uTitle,a=e._uMain,c=e._nTitleAuto;ecui.ui.Control.prototype.$setSize.call(e,d,b);d=e.getBodyWidth();b=e.getBodyHeight();f.setSize(c==1?d:0,c==2?b:0);a.setSize(d,b)},hide:function(){ecui.ui.Control.prototype.hide.call(this);ecui.mask()},setTitle:function(a){this._uTitle.$setBodyHTML(a)},show:function(){var c=this,b=ecui,a=b.ui.Control.prototype.show.call(c);c.contain(b.getFocused())||b.setFocused(c);return a},showModal:function(){this.show();this.getOuter().style.zIndex=32768;ecui.mask(0.05)}},{_aForm:[],_nBaseIndex:4096,closeclick:function(){this.getParent().hide()},titledown:function(c){var a=ecui,b=this.getParent();b.contain(a.getFocused())||a.setFocused(b);a.drag(b,c)}});ecui.ui.Tree=function(d,e,h){var f=this,a=ecui,g=a.dom,b=g.first(e),c=0;a.ui.Control.call(f,d,e,h);f.onpaint=a.cancel;f._aTree=[];if(b&&b.tagName=="LABEL"){o=f._eItems=g.insertFloor(e);e.appendChild(b);b=h.type;g.insertAfter(o,e).className=b+"-items "+(b!=d?d+"-items":"");for(b=g.children(o);o=b[c];c++){h.element=o;f.add(f.$createChild(h))}}if(!e.offsetWidth||h.fold){e.style.display="";f.setFold()}};ecui.util.inherits(ecui.ui.Tree,ecui.ui.Control,{$click:function(){var a=this._eItems;a&&this.setFold(!!a.offsetWidth)},$createChild:function(a){return ecui.create("Tree",a)},$dispose:function(){this._eItems=null;ecui.ui.Control.prototype.$dispose.call(this)},$paint:function(){var a=this;a.setClass(a.getBaseClass()+(a._aTree.length?a._eItems.offsetWidth?"":"-fold":"-empty"))},$setSize:ecui.blank,add:function(d,b){var c=this,e=d,a=c._aTree;if("string"==typeof d){d=c.$createChild({baseClass:c.getBaseClass()});d.$setBodyHTML(e)}d.setParent(c);if(d.getParent()&&(e=a[b])&&e!=d){a.splice(b,0,a.pop());e=c._eItems.insertBefore(d.getOuter(),e.getOuter());a=d._eItems;a&&ecui.dom.insertAfter(a,e)}return d},getFirst:function(){return this._aTree[0]},getLast:function(){var a=this._aTree;return a[a.length-1]},getNext:function(){var a=this.getParent();if(a instanceof ecui.ui.Tree){a=a._aTree;return a[ecui.array.indexOf(a,this)+1]}},getPrev:function(){var a=this.getParent(),b;if(a instanceof ecui.ui.Tree){a=a._aTree;return a[ecui.array.indexOf(a,this)-1]}},getChildTrees:function(){return this._aTree},hide:function(){var a=this,b=a._eItems;b=b&&b.style;if(ecui.ui.Control.prototype.hide.call(a)&&b){a._sItemsDisplay=b.display;b.display="none";return true}},setFold:function(a){a=a!==false;var b=this;if(b._aTree.length){b._eItems.style.display=a?"none":"";b.setClass(b.getBaseClass()+(a?"-fold":""));b.change()}},setParent:function(k){var j=this,d=ecui,e=d.dom,g=e.insertAfter,c=ecui.ui.Tree,h=d.ui.Control.prototype.setParent,l=j.getParent();if(l instanceof c){i=l._aTree;d.array.remove(i,j);l.$paint()}if(k instanceof c){var b=k._eItems,i=k._aTree,a=k.getType(),f=k.getBaseClass();if(!b){b=k._eItems=e.create();b.className=a+"-items "+(a!=f?f+"-items":"");g(b,k.getOuter())}k.$setBody(b);h.call(j,k);k.$setBody(k.getBody());i.push(j);k.$paint()}else{h.call(j,k)}b=j._eItems;b&&(k?g(b,j.getOuter()):e.remove(b))},show:function(){var a=this,b=a._sItemsDisplay;if(ecui.ui.Control.prototype.show.call(this)&&b!==void (0)){a._eItems.style.display=b;a._sItemsDisplay=void (0);return true}}});ecui.ui.Table=function(q,d,h){var r=this,g=ecui,l=g.dom,p=l.create,e=l.children,c=h.type,f=g.ui.Table,a=f.getHTML,k=["VScroll","HScroll"],t=r._aRow=[];r._aCol=[];if(d.tagName=="TABLE"){var u=d.getElementsByTagName("tbody")[0],b=d;u=e(u&&u.parentNode==d?u:d);m=u.splice(0,1)[0];d=l.insertAfter(p(),d);d.className=b.className;d.style.cssText=b.style.cssText;l.remove(b)}h.wheelDelta=1;g.ui.Panel.call(r,q,d,h);r.$paint=g.blank;while(b=k.pop()){if(b=r["_c"+b]=r.$getSection(b)){b.$getSection("Block").$dragmove=f.blockmove}}b=r._uHead=g.create("Control",{baseClass:q+"-area",parent:d,type:c+"-area"});k=b.getBase();k.style.cssText="overflow:hidden;position:absolute;top:0px";k=l.insertFloor(k);k.style.cssText="white-space:nowrap;position:absolute";k.innerHTML=a();b.$setBody(k=k.lastChild.lastChild.appendChild(m?m:p("tr")));if(m){for(var n=0,m=e(m);b=m[n];n++){r.addCol(b);b=f.getInfo(b.getControl());for(k=0;g=u[k];k++){n||(g=u[k]=e(g));g=g[n];l.addClass(g,b.n);g._sClass=b.c;g=g.style;g.width=b.w}}d=r.getBody();for(n=0;m=u[n];n++){b=p(a(q,c),d);b.lastChild.lastChild.appendChild(m[0].parentNode);t.push(r.$initRow(b))}}delete r.$paint};ecui.util.inherits(ecui.ui.Table,ecui.ui.Panel,{$flushScroll:function(){var c=this,b=c.getBody().style,a=Math.max,e=a(c.getScrollTop(),0),d=a(c.getScrollLeft(),0);b.left=c._uHead.getBase().lastChild.style.left=-d+"px";b.top=-e+"px"},$initRow:function(h){for(var d=this,a=ecui,c=a.ui.Table,f=d._aCol,b=0,e=a.dom.children(h.lastChild.lastChild.lastChild),g;g=e[b];b++){f[b]._bEllipsis&&a.dom.setStyle(g,"textOverflow","ellipsis");g.ondblclick=c.dblclick}g=a.$fastCreate(a.ui.Control,h,{type:d.getType()+"-row"});h.style.position="relative";g.$setBody(h.lastChild.lastChild.lastChild);g._aCol=e;a.util.copy(g,c.Row);g.getCol=d.getCol;return g},$paint:function(){var k=this,f=ecui,a=f.dom.sumStyles,q=k._cVScroll,d=k._cHScroll,n=k._uHead,g=0,r=0,m=k._aCol,t=k._aRow,b=k.getBase(),p=b.parentNode,j=0,l=k.getWidthRevise(),e,c,h=f.ui.Panel.prototype.$paint;k.$paint=f.blank;k._nTableWidth&&k.$setSize(k._nTableWidth);if(m[0]){c=n.getBody().offsetHeight;n.setSize(0,c);b.style.paddingTop=c+"px";for(;c=m[j];j++){c.isShow()&&(g+=c.getWidth())}n.getBase().lastChild.lastChild.style.width=g+"px";for(j=0;c=t[j];j++){r+=c.getHeight();c.getBase().lastChild.style.width=g+"px"}k.$setSize(d?0:g+a(p,"borderLeftWidth","borderRightWidth")+(q&&k.getBodyHeight()<r?q.getWidth():0)+l,q?0:r+a(p,"borderTopWidth","borderBottomWidth")+(d&&k.getBodyWidth()<g?d.getHeight():0)+k.getHeightRevise());n.getOuter().style.left=a(b,"paddingLeft")+"px";h.call(k);q=q&&q.isShow()?q.getWidth():0;if(d){if(!d.isShow()){k._nTableWidth=k.getWidth();k.$setSize(g-q+l);h.call(k)}else{delete k._nTableWidth}n.setSize(k.getBodyWidth()-q)}else{n.setBodySize(g)}}else{k.hide()}delete k.$paint},$resize:function(){var b=this,a=0,c=b._aRow,d=b._aCol,e;ecui.ui.Panel.prototype.$resize.call(b);row=b.getWidth();for(;e=d[a];a++){(widthRate=e._nWidthRate)&&e.$setWidth(Math.floor(row*widthRate/100))}},$scroll:function(){var h=this,m=ecui.dom.sumStyles,p=h._cVScroll,c=h._cHScroll,b=h.getBody(),l=h.getScrollTop(),d=h.getScrollLeft(),q=h._aRow,k=q.length,j=h._aCol,n=j.length,f=-m(b,"top"),e=-m(b,"left");while(!h.onscroll||h.onscroll()!==false){h.$scroll=h.$flushScroll;h.$scroll();if(l>0&&l<p.getTotal()){if(l>f){for(var g=1,a=q[0].getHeight();g<k;g++){m=a+q[g].getHeight();if(l<=m){if(a<=f){a=m}p.setValue(a);break}a=m}}else{if(l<f){for(a=b.offsetHeight;k--;){a-=q[k].getHeight();if(l>=a){p.setValue(a);break}}}}}if(d>0&&d<c.getTotal()){if(d>e){for(g=1,a=j[0].getWidth();g<n;g++){m=a+j[g].getWidth();if(d<=m){if(a<=e){a=m}c.setValue(a);break}a=m}}else{if(d<e){for(a=b.offsetWidth;n--;){a-=j[n].getWidth();if(d>=a){c.setValue(a);break}}}}}break}delete h.$scroll},addCol:function(e,k){var l=this,d=ecui,c=d.ui.Table,g=d.dom.create,j=d.dom.setStyle,q=l._aRow,n=l._aCol,m=l._uHead,f=0,p=m.getBody(),b=n[k];if(e.tagName){var a=e.style.width,h=e.className.split(/\s+/)[0]}else{a=e.width;h=e.baseClass;e=g("<th>"+(d.string.trim(e.title)||"&nbsp;")+"</th>")}if(b){b.parentNode.insertBefore(e,b.getOuter())}else{k=n.length;p.appendChild(e)}e=d.create("Control",{baseClass:h||l.getClass()+"-head",element:e,parent:true,type:l.getType()+"-head"});if(/%$/.test(a)){a=parseInt(a);a=Math.floor(l.getWidth()*a/100)}else{a=parseInt(a)}b=e.getOuter();b.style.width=a+"px";j(b,"float","left");e.$setSize(e.getWidth(),m.getBodyHeight());j(b,"float","");d.util.copy(e,d.ui.Table.Col);n.splice(k,0,e);e=c.getInfo(e);for(;p=q[f];f++){b=p.getBody();n=p._aCol;a=n[k];h=g(c.getHTML(e));b=a?a.parentNode.insertBefore(h,a):b.appendChild(h);n.splice(k,0,b);b._sClass=e.c;b.ondblclick=c.dblclick}l.$paint()},addRow:function(g,k){var l=this,h=ecui.dom.create,d=ecui.ui.Table,a=d.getHTML,j=l.getClass(),c=l.getType(),m=l._aCol,f=0,n=["<tr>"],e=[],q=l._aRow,p=q[k],b;if(p){p=p.getOuter()}else{p=null;k=q.length}p=l.getBody().insertBefore(h(a(j,c)),p);for(;b=m[f];f++){b=d.getInfo(b);e.push(b.c);n.push(a(b,g[f]))}b=h(n.join("")+"</tr>",p.lastChild.lastChild);q.splice(k,0,l.$initRow(p));for(f=0,b=b.firstChild;b;f++,b=b.nextSibling){b._sClass=e[f]}l.$paint()},addRows:function(d,a){var c=this,b=0,e;c.$paint=ecui.blank;for(;e=d[b];b++){c.addRow(e,a++)}delete c.$paint;c.$paint()},cancel:function(){var f=this,g=f._aCol,d=0,b=f._cEdit,c;if(b){f._cEdit=null;for(;c=g[d];d++){var e=c._cEditor,a=b._aCol[d];if(e){e.setParent();a.innerHTML=a.firstChild.innerHTML}}f.$paint()}},getCell:function(b,a){b=this._aRow[b];return b&&b._aCol[a]},getCol:function(a){return this._aCol[a]},getRow:function(a){return this._aRow[a]},removeCol:function(a){var c=this,e=c._aCol.splice(a,1)[0],b=0,d=c._aRow;if(e){e.setParent();for(;e=d[b];b++){ecui.dom.remove(e._aCol.splice(a,1)[0]);e.clearCache()}c.$paint()}},removeRow:function(a){if(a=this._aRow.splice(a,1)[0]){a.setParent();for(var b=0,c=a._aCol,d;d=c[b];b++){ecui.dom.remove(d)}this.$paint()}},removeRows:function(){var b=this,a=rows.length;b.$paint=ecui.blank;while(a--){b.removeRow(a)}delete b.$paint;b.$paint()},save:function(){var j=this,d=ecui.dom,f=d.setText,h=d.setStyle,l="textOverflow",k=j._aCol,e=0,c=j._cEdit,b;if(c){j._cEdit=null;for(;b=k[e];e++){var g=b._cEditor,a=c._aCol[e];if(g){g.setParent();g=g.getValue();if(b._bEllipsis){h(a,l,"");f(a,g);h(a,l,"ellipsis")}else{a.innerHTML="";f(a,g)}}}j.$paint()}}},{blockmove:function(d,a,e){var c=this,b=c.getParent().getParent();b.$scroll=b.$flushScroll;ecui.ui.Scroll.Block.$dragmove.call(c,d,a,e);delete b.$scroll},cellout:function(a,c){var b=this.getParent().oncellout;b&&b.call(a,c)===false||ecui.dom.removeClass(a,a._sClass+"-over")},dblclick:function(){var a=ecui.findControl(this);a.getParent()._aCol[ecui.array.indexOf(a._aCol,this)]._cEditor&&a.edit()},getHTML:function(b,a){return"object"!=typeof b?(b?'<div class="'+b+"-row "+(b!=a?a+"-row":"")+'">':"")+'<table cellspacing="0" style="border-spacing:0px;table-layout:fixed"><tbody></tbody></table>'+(b?"</div>":""):'<td class="'+b.n+'" style="width:'+b.w+'">'+(a||"&nbsp;")+"</td>"},getInfo:function(d){var b=ecui,f=d.getBase(),c=b.dom.sumStyles,a=d.getType(),e=d.getClass(),g=e.replace(/-head$/,"")+"-item";return{w:b.dom.getStyle(f,"width"),c:g,n:g+(e!=a?" "+a.replace(/-head$/,"")+"-item":"")}},getTarget:function(b){for(var a=0,d=this._aCol,c=b.target,e;e=d[a];a++){if(ecui.dom.contain(e,c)){return e}}},Row:{$click:function(c){var b=this,a=b.getParent().onrowclick;a&&a.call(b,c);ecui.ui.Control.prototype.$click.call(b,c)},$dispose:function(){this._aCol=this._eOver=null;ecui.ui.Control.prototype.$dispose.call(this)},$mousedown:function(e){var d=this,c=d.getParent(),a=c._eCol=ecui.ui.Table.getTarget.call(d,e),b=c.oncelldown,f=c.onrowdown;a&&b&&b.call(a,e);f&&f.call(d,e);ecui.ui.Control.prototype.$mousedown.call(d)},$mousemove:function(a){var f=this,h=f.getParent(),e=f._eOver,c=ecui.ui.Table,b=f._eOver=c.getTarget.call(f,a),g=h.onrowmove,d=h.oncellout,i=h.oncellmove;if(e!=b){e&&c.cellout.call(f,e,a);b&&(d&&d.call(b,a)===false||ecui.dom.addClass(b,b._sClass+"-over"))}b&&i&&i.call(b,a);g&&g.call(f,a);ecui.ui.Control.prototype.$mousemove.call(f)},$mouseout:function(c){var b=this,a=b.getParent().onrowout,d=b._eOver;d&&ecui.ui.Table.cellout.call(b,d,c);b._eOver=null;a&&a.call(b,c);ecui.ui.Control.prototype.$mouseout.call(b)},$mouseover:function(c){var b=this,a=b.getParent().onrowover;a&&a.call(b,c);ecui.ui.Control.prototype.$mouseover.call(b)},$mouseup:function(e){var d=this,c=d.getParent(),a=ecui.ui.Table.getTarget.call(d,e),b=c.oncellup,f=c.onrowup;a&&b&&b.call(a,e);f&&f.call(d,e);ecui.ui.Control.prototype.$mouseup.call(d)},$pressend:function(e){var d=this,c=d.getParent(),a=ecui.ui.Table.getTarget.call(d,e),b=c.oncellclick;a&&c._eCol==a&&b&&b.call(a);c._eCol=null;ecui.ui.Control.prototype.$pressend.call(d)},edit:function(){var d=this,h=ecui.dom,c=d.getParent(),e=c._aCol,a=0,g=c._cEdit;if(!g||d!=g&&(!d.onsave||d.onsave()!==false)){c.save();c._cEdit=d;for(;g=e[a];a++){var b=g._cEditor,f=d._aCol[a];if(b){g.onupdate&&g.onupdate(b)===false||b.setValue(h.getText(f));g=h.insertFloor(f);g.style.cssText="overflow:hidden;white-space:nowrap";b.setParent(f);b.getOuter().style.top=h.getStyle(f,"paddingTop");b.setSize(g.offsetWidth,g.offsetHeight);g.style.cssText="visibility:hidden"}}}}},Col:{$setStyles:function(a,g){var j=this.getParent().getParent(),h=ecui.array.indexOf(j._aCol,this),d=0,k=j._aRow,e=a=="textOverflow"&&g,f=j._aCol,c=0,b;if(e){for(;b=f[d];d++){b.isShow()&&(c+=b.getWidth())}d=0}for(;b=k[d];d++){e&&(b.getBase().lastChild.style.width=c+"px");ecui.dom.setStyle(b._aCol[h],a,g);b.clearCache()}j.$paint()},$setWidth:function(b){var c=this,a=c._bEllipsis;a&&c.setEllipsis();ecui.ui.Control.prototype.setSize.call(c,b);c.$setStyles("width",ecui.dom.getStyle(c.getOuter(),"width"));a&&c.setEllipsis(a)},hide:function(){if(ecui.ui.Control.prototype.hide.call(this)){this.$setStyles("display","none");return true}},setEditor:function(a){if(!this.getParent().getParent()._cEdit){a.getOuter().style.position="absolute";this._cEditor=a}},setEllipsis:function(a){this._bEllipsis=a;a=a?"ellipsis":"";ecui.dom.setStyle(this.getBody(),"textOverflow",a);this.$setStyles("textOverflow",a)},setSize:function(a){this.$setWidth(a);this._nWidthRate=null},show:function(){if(ecui.ui.Control.prototype.show.call(this)){this.$setStyles("display","");return true}}}});ecui.ui.LockedTable=function(l,b,g){var n=this,f=ecui,k=f.dom.create,c=g.type,e=f.ui.Table,a=n._uLockedMain=f.create("Control",{element:j=k('<div class="'+l+'-layout" style="overflow:hidden;position:relative"><div style="white-space:nowrap;position:absolute;top:0px;left:0px;"></div></div>'),type:c+"-layout"}),d=n._nLeftLock=g.leftLock||0,q=n._nRightLock=g.rightLock||0;a.$setBody(j.lastChild);n._aLockedRow=[];e.call(n,l,b,g);b=n.getBase();var j=b.insertBefore(k('<div style="position:absolute;top:0px;left:0px"><div class="'+l+'-area" style="overflow:hidden">'+e.getHTML()+"</div></div>"),b.firstChild),m=j.lastChild,p=n._aCol,h=0;a.setParent(j);a=n._uLockedHead=f.create("Control",{element:m,type:c+"-area"});a.setSize(0,f.dom.sumStyles(b,"paddingTop"));a.$setBody(j=k('<tr><th style="padding:0px"></th></tr>',m.lastChild.lastChild));b=j.lastChild;q=p.length-q;for(;a=p[h];h++){a=a.getOuter();h<d?j.insertBefore(a,b):h>=q&&j.appendChild(a)}};ecui.util.inherits(ecui.ui.LockedTable,ecui.ui.Table,{$flushScroll:function(){ecui.ui.Table.prototype.$flushScroll.call(this);this._uLockedMain.getBody().style.top=this.getBody().style.top},$initRow:function(p){var k=this,f=ecui,e=f.ui.Table,p=e.prototype.$initRow.call(k,p),c=k.getType(),a=f.util.copy,j=f.dom.create,g=k._aLockedRow,n=k._aRow,d=k._nLeftLock,m=k._aCol.length-k._nRightLock,b=j(e.getHTML(k.getBaseClass(),c),k._uLockedMain.getBody());lockedRow=f.$fastCreate(f.ui.Control,b,{type:c+"-row"}),parentEl=j('<tr class="'+p.getBody().className+'"><td style="padding:0px"></td></tr>',lockedRow.getBody().lastChild.lastChild),rowFuncs=f.ui.LockedTable.Row;a(lockedRow,e.Row);lockedRow.$setBody(parentEl);g.splice(f.array.indexOf(n,p),0,lockedRow);a(p,rowFuncs);a(lockedRow,rowFuncs);p._cJoint=lockedRow;lockedRow._cJoint=p;b=p.getBody();b.style.height=parentEl.style.height=b.offsetHeight+"px";for(var l=lockedRow._aCol=p._aCol,h=0;b=l[h];h++){h<d?parentEl.insertBefore(b,parentEl.lastChild):h>=m&&parentEl.appendChild(b)}return p},$paint:function(){for(var q=0,w=this,r=ecui,l=r.dom.sumStyles,e=r.dom.children,j=w._aRow,k=w._aCol,b=w._uLockedHead,h=w._aLockedRow,g=w.getBase(),n=g.style,d=w._nLeftLock,u=k.length-w._nRightLock,v=w._cVScroll,t=w._cHScroll,z=g.firstChild.lastChild,A=l(z,"borderLeftWidth"),a=l(z,"borderRightWidth"),m=A+a,p,f,c=r.cancel;f=k[q];q++){if(f.isShow()){p=f.getWidth();if(q<d){A+=p;f.isShow=c}else{if(q>=u){a+=p;f.isShow=c}}}}f=w.getWidth();n.paddingLeft=A+"px";n.paddingRight=a+"px";for(q=0;n=h[q];q++){r.dom.children(n.getBody())[d].style.width="0px";n.getBase().lastChild.style.width="0px"}w.$paint=c;w.$setSize(f);delete w.$paint;r.ui.Table.prototype.$paint.call(w);b.setSize(0,w._uHead.getHeight());for(q=0;f=k[q];q++){delete f.isShow}v=v&&v.isShow()?v.getWidth():0;p=w.getWidth(true)-l(g,"borderLeftWidth","borderRightWidth")-v;f=w.getBodyWidth()-(t?v:A+a-m)+"px";b.getBase().lastChild.style.width=p+"px";e(b.getBody())[d].style.width=f;for(q=0;n=h[q];q++){n.getBase().lastChild.style.width=p+"px";e(n.getBody())[d].style.width=f}b.setSize(p);w._uLockedMain.setSize(p,w.getBodyHeight()-(t&&t.isShow()?t.getHeight():0))},$resize:function(){var d=this,a=0,e=d._aRow,f=d._aCol,h;ecui.ui.Table.prototype.$resize.call(d);for(a=0;h=e[a];a++){var g=h._cJoint,c=h.getBody(),b=g.getBody();c.style.height=b.style.height="";c.style.height=b.style.height=Math.max(c.offsetHeight,b.offsetHeight)+"px";h.clearCache();g.clearCache()}}});(function(){for(var e=ecui.ui.LockedTable.Row={},d=0,c,g=["$blur","$focus","$click","$mousedown","$mouseover","$mousemove","$mouseout","$mouseup","$pressstart","$pressover","$pressmove","$pressout","$pressend"],a=".apply(this",f=",arguments)",b;c=g[d];d++){b="ecui.ui.Control.prototype."+c;e[c]=new Function("","(ecui.ui.Table.Row."+c+"||"+b+")"+a+f+";"+b+a+"._cJoint"+f)}})();ecui.ui.Popup=function(c,d,f){var e=this,a=ecui,b=0;a.ui.Control.call(e,c,d,f);d=e.getOuter();e.onpaint=a.cancel;e.setParent(document.body);a.dom.setStyles(d,{display:"none",position:"absolute"});e.$initItems();e.setParent=a.blank;for(a=e.getItems();e=a[b];b++){e._cPopup&&e.setClass(c+"-item-complex")}};ecui.util.inherits(ecui.ui.Popup,ecui.ui.Control,{$blur:function(){for(var a=this,b;b=a._cSuperior;a=b){}a.hide()},$custom:function(){this.$blur()},$forcibly:function(b){var c=b.getTarget(),a=ecui.ui.Popup;if(c&&c.getParent() instanceof a){c.mousedown();c.getChildItems().length||c.click(b)}a._cFocus.$blur();return false},$initItem:function(d){var e=this,a=ecui,c=d.getBody();a.util.copy(d,a.ui.Popup.Item);var b=a.dom.first(c);if(b&&b.tagName=="LABEL"){e=a.dom.insertFloor(c);c.appendChild(b);a.ui.Popup.create(d,e);d.$setBodyHTML(b.innerHTML)}},$paint:function(){var e=this,d=e.getParent(),b=e.getItems(),c=b.length,a=0;d&&d.setClass(d.getBaseClass()+(c?"-complex":""));while(c--){a+=b[c].getHeight()}e.$paint=ecui.blank;e.setBodySize(0,a);delete e.$paint},getSuperior:function(){var a=this.getParent();return a&&a.getParent()},hide:function(){var b=this,c=ecui.ui,d=b._cSuperior,a=b._cInferior;if(c.Control.prototype.hide.call(b)){b.clearOvered();a&&a.hide();c.Popup._cFocus=d;d?(d._cInferior=null):ecui.restore()}},show:function(){b=ecui;b.ui.Control.prototype.show.call(this);var g=this,f=Math,b,c=b.Browser(),e=b.ui.Popup,a=e._cFocus,d=g.getOuter(),h=b.dom.getPosition(d);g.setPosition(f.min(f.max(h.left,c.left),c.right-g.getWidth()),f.min(f.max(h.top,c.top),c.bottom-g.getHeight()));if(a){d.style.zIndex=b.dom.sumStyles(a.getOuter(),"zIndex")+1;g._cSuperior=a;a._cInferior=g}else{d.style.zIndex=32768;b.forcibly(g)}e._cFocus=g}},{create:function(c,b){var a=c._cPopup=ecui.create("Popup",{baseClass:c.getParent().getClass(),element:b});a.$setParent(c);return a},Item:{$mouseover:function(){var f=this,d=ecui,i=f._cPopup,a=f.getParent(),j=a.getSuperior(),c=a._cInferior,g=d.dom.getPosition(f.getOuter()),e=d.Browser();d.ui.Item.prototype.$mouseover.call(f);if(c!=i){c&&c.hide();if(i&&i.getItems()[0]){var h=g.left,b=i.getWidth();c=h+f.getWidth()-4;h-=b-4;if(j&&j.getX()>a.getX()&&h>e.left||c+b>e.right){c=h}i.setPosition(c,g.top-4);i.show()}}},$mouseout:function(){this.getChildItems()[0]||this.getParent().clearOvered()},add:function(b,a){return(this._cPopup||ecui.ui.Popup.create(this)).add(b,a)},getChildItems:function(){var a=this._cPopup;return a?a.getItems():[]}}});ecui.util.copy(ecui.ui.Popup.prototype,ecui.ui.Items);ecui.ui.Listbox=function(a,b,e){var c=this,d=ecui.ui;e.horizontalScroll=false;c._sName=e.name||"";c.$append=ecui.blank;d.Panel.call(c,a,b,e);delete c.$append;c._cScroll=c.$getSection("VScroll");c.$initItems()};ecui.util.inherits(ecui.ui.Listbox,ecui.ui.Panel,{$initItem:function(d,e){var a=ecui,c=d.getBody(),b=d._eInput=a.dom.create('<input type="hidden" name="'+this._sName+'" disabled>',c);b.value=e===void (0)?c.getAttribute("value")||"":e;a.util.copy(d,a.ui.Listbox.Item);d.setSelected(!!c.getAttribute("selected"))},$paint:function(){var c=this,b=c.getItems()[0],a=c._cScroll;b&&a.setStep(b.getHeight());c.setItemSize(c.getBodyWidth()-(c.getBody().offsetHeight>c.getBodyHeight()?a.getWidth():0));ecui.ui.Panel.prototype.$paint.call(c)},getName:function(){return this._sName},getSelected:function(){for(var b=0,c=this.getItems(),a=[],d;d=c[b];b++){d.isSelected()&&a.push(d)}return a},selectAll:function(){for(var a=0,b=this.getItems(),c;c=b[a];a++){c.setSelected(true)}},setName:function(a){for(var b=0,d=this.getItems(),c;c=d[b];b++){c._eInput=ecui.dom.setInputName(c._eInput,a)}this._sName=a}},{Item:{$mousedown:function(a){ecui.select(this,a,"listbox")},$select:function(){var h=this,i=h._nStartIndex,e=h._nLastIndex,f=h._calcOvered(),g=h.getParent().getItems(),d=0,b=-1,a=0,c=-1;if(f>e){if(f<i){d=e;b=f-1}else{if(e<i){d=e;b=i-1;a=i+1;c=f}else{a=e+1;c=f}}}else{if(f<e){if(f>i){d=f+1;b=e}else{if(e>i){d=i+1;b=e;a=f;c=i-1}else{a=f;c=e-1}}}}h._nLastIndex=f;for(;d<=b;d++){h=g[d];h.alterClass("selected",!h.isSelected())}for(;a<=c;a++){g[a].alterClass("selected")}},$selectend:function(){var d=this,f=d._nStartIndex,b=d._calcOvered(),a=d.getParent().getItems(),c=Math.min(f,b),e=Math.max(f,b);if(f==b){d.setSelected(!d.isSelected())}else{for(;c<=e;c++){a[c].setSelected()}}},$selectstart:function(){var a=this;a._nStartIndex=a._nLastIndex=a._calcOvered();a.alterClass("selected")},isSelected:function(){return !this._eInput.disabled},setParent:function(a){var b=this;ecui.ui.Item.prototype.setParent.call(b,a);if(a=b.getParent()){b._eInput=ecui.dom.setInputName(b._eInput,a._sName)}},setSelected:function(a){this.alterClass("selected",this._eInput.disabled=a===false)},_calcOvered:function(){var g=this,f=Math,e=f.floor,c=g.getParent(),b=c._cScroll,d=b.getStep(),h=ecui.getMouseY(c),a=g._nTop;g._nTop=h;if(h>c.getHeight()){if(h<a){h=0}else{h=e((h-f.max(0,a))/3);h?b.skip(h):(g._nTop=a)}h+=g._nLastIndex}else{if(h<0){if(h>a){h=0}else{h=f.ceil((h-f.min(0,a))/3);h?b.skip(h):(g._nTop=a)}h+=g._nLastIndex}else{h=e((c.getScrollTop()+h)/d)}}return f.max(0,f.min(h,c.getItems().length-1))}}});ecui.util.copy(ecui.ui.Listbox.prototype,ecui.ui.Items);ecui.ui.Progress=function(b,c,g){d=this;ecui.ui.Control.call(d,b,c,g);var d,a=d.getBody(),f=ecui.dom,e=a.innerHTML;s='<div style="position:absolute;left:0px;top:0px" class="'+b;f.coordinates(a);d._eText=f.create(s+'-text"></div>',a);d._eComplete=f.create(s+'-complete"></div>',a);d.setText(g.rate||0,e||"")};ecui.util.inherits(ecui.ui.Progress,ecui.ui.Control,{$dispose:function(){this._eText=this._eComplete=null;ecui.ui.Control.prototype.$dispose.call(this)},$setSize:function(c,a){var e=this,d=e._eText.style,b=e._eComplete.style;ecui.ui.Control.prototype.$setSize.call(e,c,a);d.width=b.width=e.getBodyWidth()+"px";d.height=b.height=e.getBodyHeight()+"px"},setText:function(b,d){var c=this,a=c._eComplete;b=Math.max(Math.min(b,1),0);d=d||(b*100)+"%";c._eText.innerHTML=d;a.innerHTML=d;a.style.clip="rect(0px,"+Math.floor(b*c.getBodyWidth())+"px,"+c.getBodyHeight()+"px,0px)"}});ecui.ext={};ecui.ext.Decorator=function(g,j){var l=this,f=ecui,e=f.ext.Decorator,b=g.getUID(),d=(l._oInner=e[b]||g).getOuter(),a=d.style,i=d.parentNode,h=a.position,k=a.display,c=l._eOuter=f.dom.create();c.className=l._sClass=j||g.getBaseClass()+"-decorator";c.style.cssText="position:"+(h=="absolute"?h:"relative")+";top:"+(a.top||"auto")+";left:"+(a.left||"auto")+(k?";display:"+k:"");f.dom.setStyles(d,{position:"relative",top:"auto",left:"auto",display:""});i&&i.insertBefore(c,d);c.appendChild(d);e[b]=l;f.util.copy(g,l.Proxy)};ecui.util.copy(ecui.ext.Decorator.prototype,{$alterClass:function(b,a){var c=this;ecui.dom[a?"removeClass":"addClass"](c._eOuter,c._sClass+"-"+b);c._oInner.$alterClass(b,a,true);c.paint()},$dispose:function(){this._eOuter=null},$setSize:function(b,h){var f=this,d=ecui.dom,c=f._eOuter,a=c.style,i=f._oInner,g=d.getInvalidWidth(c),e=d.getInvalidHeight(c);f._oInner.$setSize(b&&b-g,h&&h-e,true);a.width=(b=i.getWidth(true))+"px";a.height=(h=i.getHeight(true))+"px";f._nWidth=b+g;f._nHeight=h+e;f.paint()},getClass:function(){return this._sClass},getHeight:function(){var a=this;return a._nHeight=a._nHeight||a._oInner.getHeight(true)+ecui.dom.getInvalidHeight(a._eOuter)},getHeightRevise:function(){return this._oInner.getHeightRevise(true)+ecui.dom.getInvalidHeight(this._eOuter)},getInner:function(){return this._oInner},getOuter:function(){return this._eOuter},getWidth:function(){var a=this;return a._nWidth=a._nWidth||a._oInner.getWidth(true)+ecui.dom.getInvalidWidth(a._eOuter)},getWidthRevise:function(){return this._oInner.getWidthRevise(true)+ecui.dom.getInvalidWidth(this._eOuter)},paint:ecui.blank});(function(){var proxy=ecui.ext.Decorator.prototype.Proxy={$dispose:function(){this.clear();this.$dispose()},clear:function(){var me=this,constructor=ecui.ext.Decorator;for(o in constructor.prototype.Proxy){eval("delete me."+o)}var id=me.getUID(),o=constructor[id],el=o._eOuter;el.parentNode.insertBefore(me.getOuter(),el);ecui.dom.remove(el);for(;o!=me;o=o._oInner){o.$dispose()}constructor[id]=null},getOuter:function(){return ecui.ext.Decorator[this.getUID()].getOuter()}},list=[["$setSize",2],["$alterClass",2],["getWidthRevise",0],["getHeightRevise",0],["getWidth",0],["getHeight",0]],i=0,o,name;for(;o=list[i];i++){name=o[0];proxy[name]=new Function("var o=this,d=ecui.ext.Decorator[o.getUID()],r=arguments;return r["+o[1]+"]?o.constructor.prototype."+name+".apply(o,r):d."+name+".apply(d,r)")}})();ecui.ext.LRDecorator=function(d,b){c=this;ecui.ext.Decorator.call(c,d,b);var c,e='<div class="'+c.getClass(),a='" style="position:absolute;left:0px"></div>';ecui.dom.create(e+"-left"+a+e+"-right"+a,d.getOuter());c.paint()};ecui.util.inherits(ecui.ext.LRDecorator,ecui.ext.Decorator,{paint:function(){var f=this,d=ecui.dom,e=d.getStyle,g=d.setStyles,b=f.getOuter(),i=e(b,"paddingTop"),c=e(b,"paddingLeft"),j=f.getInner(),h=j.getHeight(true)+"px",a=b.lastChild;g(a,{top:i,left:(parseInt(c)||0)+j.getWidth(true)+"px",width:e(b,"paddingRight"),height:h});g(a.previousSibling,{top:i,width:c,height:h})}});ecui.ext.TBDecorator=function(d,b){c=this;ecui.ext.Decorator.call(c,d,b);var c,e='<div class="'+c.getClass(),a='" style="position:absolute;top:0px"></div>';ecui.dom.create(e+"-top"+a+e+"-bottom"+a,d.getOuter());c.paint()};ecui.util.inherits(ecui.ext.TBDecorator,ecui.ext.Decorator,{paint:function(){var g=this,e=ecui.dom,f=e.getStyle,h=e.setStyles,c=g.getOuter(),i=f(c,"paddingTop"),d=f(c,"paddingLeft"),j=g.getInner(),b=j.getWidth(true)+"px",a=c.lastChild;h(a,{top:(parseInt(i)||0)+j.getHeight(true)+"px",left:d,width:b,height:f(c,"paddingBottom")});h(a.previousSibling,{left:d,width:b,height:i})}});ecui.ext.MagicDecorator=function(d,b){var c=this,a=0;ecui.ext.Decorator.call(c,d,b);b=c.getClass();for(;a<9;a++){a!=4&&ecui.dom.create('<div class="'+b+"-widget"+a+'" style="position:absolute"></div>',c.getOuter())}c.paint()};ecui.util.inherits(ecui.ext.MagicDecorator,ecui.ext.Decorator,{paint:function(){var k=this,g=ecui.dom,j=g.getStyle,c=k.getOuter(),q=k.getInner(),h=9,n=j(c,"paddingTop"),f=j(c,"paddingLeft"),b=q.getWidth(true),m=q.getHeight(true),l=["0px",n,((parseInt(n)||0)+m)+"px"],e=["0px",f,((parseInt(f)||0)+b)+"px"],a=c.lastChild;b=[f,b+"px",j(c,"paddingRight")];m=[n,m+"px",j(c,"paddingBottom")];while(h--){if(h!=4){var p=Math.floor(h/3),d=h%3;g.setStyles(a,{top:l[p],left:e[d],width:b[d],height:m[p]});a=a.previousSibling}}}});